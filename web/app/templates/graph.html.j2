{% extends 'base.html' %}
{% block styles %}
  {{ super() }}
  {{ styles }}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.23.0/cytoscape.min.js"></script>
  <script src="https://unpkg.com/layout-base/layout-base.js"></script>
  <script src="https://unpkg.com/cose-base/cose-base.js"></script>
  <script src="{{ url_for('static', filename='cytoscape-cose-bilkent.js') }}"></script>
  <style>
    #cy {
      width: 100%;
      height: calc(100vh - 72px);
      display: block;
    }
    .layout-controls {
      position: absolute;
      top: 84px;
      right: 20px;
      z-index: 1000;
      display: flex;
      flex-direction: row;
      justify-content: end;
      align-items: center;
    }
    .layout-controls .card,
    .layout-controls button {
      margin-left: 10px;
    }
    .layout-node-details {
      position: absolute;
      top: 84px;
      left: 20px;
      z-index: 1001;
      display: flex;
    }
  </style>
{% endblock %}
{% block content %}
<div id="cy"></div>
<div class="layout-node-details">
  <div id="node-card" class="card border-primary shadow-sm" style="display: none;">
      <div class="card-header px-2 py-1">Information</div>
      <div class="card-body px-2 py-1">
          <div id="node-name" class="card-text"></div>
          <div id="node-status" class="card-text"></div>
          <div id="node-lastseen" class="card-text"></div>
          <button id="node-btn" class="btn btn-primary btn-sm my-1 py-0">Graph</button>
      </div>
  </div>
</div>
<div class="layout-controls">
  <div class="card card-primary shadow-sm">
    <div class="card-body py-2 my-0">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="filterRegisteredSwitch">
        <label class="form-check-label" for="filterRegisteredSwitch">Show Registered Only</label>
      </div>
    </div>
  </div>
  <button id="concentricBtn" class="btn btn-primary shadow-sm">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-repeat" viewBox="0 0 16 16">
      <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41m-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9"/>
      <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5 5 0 0 0 8 3M3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9z"/>
    </svg>
  </button>
  <button id="coseBilkentBtn" class="btn btn-primary shadow-sm">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-shuffle" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.6 9.6 0 0 0 7.556 8a9.6 9.6 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.6 10.6 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.6 9.6 0 0 0 6.444 8a9.6 9.6 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5"/>
      <path d="M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192"/>
    </svg>
  </button>
</div>
<script>
  // Embed the graph data directly in the template
  const graphData = {{ graph_data|safe }};
</script>
<script src="{{ url_for('static', filename='graph.js') }}"></script>
{% endblock %}
{% block scripts %}
  {{ super() }}
{% endblock %}
